<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <title>All Interaction Types - SmartWait Test</title>
    <link rel="stylesheet" href="design-system.css">
    <style>
        /* Page-specific tag colors */
        .tag-click { background: rgba(225,29,72,0.15); color: #fb7185; }
        .tag-hover { background: rgba(251,191,36,0.15); color: #fbbf24; }
        .tag-drag { background: rgba(37,99,235,0.15); color: #60a5fa; }
        .tag-key { background: rgba(124,58,237,0.15); color: #a78bfa; }
        .tag-scroll { background: rgba(5,150,105,0.15); color: #34d399; }
        .tag-file { background: rgba(219,39,119,0.15); color: #f472b6; }
        .tag-context { background: rgba(255,255,255,0.06); color: var(--text-tertiary); }
        code { background: rgba(255,255,255,0.06); padding: 2px 6px; border-radius: 4px; font-size: 13px; color: var(--accent); }
        .result-box.updated { border-color: var(--accent); background: rgba(14,165,233,0.1); }
        .ctx-item:hover, .menu-item:hover { background: rgba(255,255,255,0.06); }
        /* DOM Context Switcher */
        .dom-switcher-bar { display:flex; gap:0; margin:16px 0 20px; border:1.5px solid var(--border-default); border-radius:var(--radius-md); overflow:hidden; max-width:480px; background:var(--bg-secondary); }
        .dom-btn { flex:1; margin:0!important; border-radius:0!important; box-shadow:none!important; padding:11px 8px; font-size:13px; font-weight:600; background:transparent; color:var(--text-secondary); border:none; transition:all .15s ease; cursor:pointer; }
        .dom-btn:hover { background:var(--bg-card-hover); color:var(--text-primary); transform:none; }
        .dom-btn-active { background:var(--accent)!important; color:white!important; }
        .dom-context-badge { display:inline-block; padding:4px 12px; border-radius:6px; font-size:12px; font-weight:700; }
    </style>
</head>
<body class="has-monitor">
<script>(function(){var t=localStorage.getItem('lt-theme')||(window.matchMedia('(prefers-color-scheme:light)').matches?'light':'dark');document.documentElement.setAttribute('data-theme',t);})();</script>

<!-- INPUT VALUE MONITOR BAR -->
<div id="inputMonitorBar">
    <span class="monitor-title">Input Monitor</span>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">Active:</span>
        <span class="monitor-element-id" id="monitorActiveField">&mdash;</span>
    </div>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">Event Value:</span>
        <span class="monitor-value" id="monitorEventValue">&mdash;</span>
    </div>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">.value:</span>
        <span class="monitor-value" id="monitorDomValue">&mdash;</span>
    </div>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">Source:</span>
        <span class="monitor-source" id="monitorSource">&mdash;</span>
    </div>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">Keys:</span>
        <span class="monitor-value" id="monitorKeyLog" style="max-width:200px;">&mdash;</span>
    </div>
    <div class="monitor-divider" id="monitorGroupDivider" style="display:none;"></div>
    <div class="monitor-field" id="monitorGroupSection" style="display:none;">
        <span class="monitor-group-label" id="monitorGroupLabel">&mdash;</span>
        <span class="monitor-value group-val" id="monitorGroupValue">&mdash;</span>
    </div>
</div>

<div class="top-bar"></div>
<div class="glow-container"><div class="glow-inner"></div></div>
<div class="glow-container glow-2"><div class="glow-inner"></div></div>

<header class="site-header">
    <div class="header-inner">
        <a href="index.html" class="logo">
            <div class="logo-icon">LT</div>
            <div class="logo-text">All Interactions</div>
        </a>
        <nav class="header-nav">
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <span class="icon-sun">&#9728;</span>
                <span class="icon-moon">&#9790;</span>
            </button>
            <a href="index.html" class="header-btn">
                <svg viewBox="0 0 20 20" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 10H5M5 10l4-4M5 10l4 4"/></svg>
                <span class="hide-mobile">All Pages</span>
            </a>
        </nav>
    </div>
</header>

<main class="container-narrow">

    <div class="page-hero">
        <h1>All Interaction Types</h1>
        <p class="subtitle">Every action type KaneAI can perform &mdash; beyond just text input</p>
    </div>

    <div class="info-box">
        Comprehensive test surface for <strong>every KaneAI action type</strong> that triggers SmartWait.
        Each section covers a different interaction pattern: clicks, hover, drag-and-drop, scroll,
        keyboard shortcuts, file upload, context menu, date/time pickers, copy/paste, and clear+retype.
    </div>

    <!-- ===== DOM Context Switcher ===== -->
    <div class="section-card featured">
        <div class="section-card-header"><h2>DOM Context Switcher</h2></div>
        <p>Same set of interactions rendered in <strong>Standard DOM</strong>, <strong>Shadow DOM</strong>, or <strong>Iframe</strong>. Switch to test how SmartWait + input handling behaves across DOM boundaries.</p>

        <div id="domSwitcherBar" class="dom-switcher-bar">
            <button onclick="switchDom('standard')" id="domBtn-standard" class="dom-btn dom-btn-active">Standard DOM</button>
            <button onclick="switchDom('shadow')" id="domBtn-shadow" class="dom-btn">Shadow DOM</button>
            <button onclick="switchDom('iframe')" id="domBtn-iframe" class="dom-btn">Iframe</button>
        </div>

        <div id="domContextLabel" style="margin-bottom:12px;">
            <span class="dom-context-badge" style="background:rgba(5,150,105,0.15);color:#34d399;">ACTIVE: Standard DOM</span>
        </div>

        <div id="domRenderTarget" style="min-height:100px;"></div>

        <div class="result-box" id="domSwitchResult">Switch DOM contexts above — interactions are identical, DOM wrapper changes</div>
    </div>

    <!-- ===== Section 1: Click Variations ===== -->
    <div class="section-card">
        <div class="section-card-header"><h2>Section 1: Click Variations</h2></div>
        <span class="tag tag-click">click</span>
        <p>Single click, double-click, right-click, click-and-hold, and click on different element types.</p>

        <h3>1a. Single Click</h3>
        <button id="singleClickBtn" onclick="recordClick('singleClickBtn', 'Single click')">Click Me</button>
        <button id="singleClickBtn2" onclick="recordClick('singleClickBtn2', 'Toggle button')" style="background:linear-gradient(135deg,#059669,#047857);box-shadow:0 2px 6px rgba(5,150,105,0.3);">Toggle State</button>
        <div id="singleClickState" style="margin:8px 0;font-size:14px;color:#34d399;font-weight:600;">State: OFF</div>

        <h3>1b. Double Click</h3>
        <div id="dblClickTarget" style="padding:20px;background:rgba(251,191,36,0.1);border-radius:10px;text-align:center;cursor:pointer;user-select:none;margin:8px 0;font-weight:600;color:#fbbf24;">
            Double-click me to edit
        </div>
        <input type="text" id="dblClickInput" style="display:none;" placeholder="Type new text, press Enter or click outside">

        <h3>1c. Right Click (Context Menu)</h3>
        <div id="rightClickTarget" style="padding:20px;background:rgba(124,58,237,0.1);border-radius:10px;text-align:center;cursor:context-menu;user-select:none;margin:8px 0;font-weight:600;color:#a78bfa;">
            Right-click me for custom context menu
        </div>
        <div id="customContextMenu" style="display:none;position:fixed;background:var(--bg-card);border:1px solid var(--border-default);border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.4);z-index:9999;min-width:160px;">
            <div class="ctx-item" onclick="ctxAction('copy')" style="padding:10px 16px;cursor:pointer;font-size:14px;border-bottom:1px solid var(--border-subtle);color:var(--text-primary);">Copy</div>
            <div class="ctx-item" onclick="ctxAction('paste')" style="padding:10px 16px;cursor:pointer;font-size:14px;border-bottom:1px solid var(--border-subtle);color:var(--text-primary);">Paste</div>
            <div class="ctx-item" onclick="ctxAction('delete')" style="padding:10px 16px;cursor:pointer;font-size:14px;color:#f87171;">Delete</div>
        </div>

        <h3>1d. Click and Hold (Long Press)</h3>
        <div id="longPressTarget" style="padding:20px;background:rgba(37,99,235,0.1);border-radius:10px;text-align:center;cursor:pointer;user-select:none;margin:8px 0;font-weight:600;color:#60a5fa;transition:all 0.3s;">
            Press and hold me (1 second)
        </div>
        <div class="counter" id="longPressTimer">Hold duration: 0ms</div>

        <h3>1e. Click on Links</h3>
        <a href="#section2" id="anchorLink" style="color:var(--accent);font-weight:600;text-decoration:underline;font-size:14px;">Internal anchor link → Section 2</a>
        <br>
        <a href="javascript:void(0)" id="jsLink" onclick="recordClick('jsLink','JS void link clicked')" style="color:#60a5fa;font-weight:600;text-decoration:underline;font-size:14px;margin-top:4px;display:inline-block;">JavaScript void link</a>

        <div class="result-box" id="clickResult">Click interactions will appear here</div>
    </div>

    <!-- ===== Section 2: Hover Interactions ===== -->
    <div class="section-card" id="section2">
        <div class="section-card-header"><h2>Section 2: Hover Interactions</h2></div>
        <span class="tag tag-hover">hover</span>
        <p>Tooltips, hover-to-reveal menus, hover state changes, and hover-triggered content.</p>

        <h3>2a. Tooltip on Hover</h3>
        <div style="display:flex;gap:12px;flex-wrap:wrap;margin:8px 0;">
            <span id="tooltipTarget1" class="tooltip-trigger" style="padding:10px 20px;background:rgba(251,191,36,0.1);border-radius:8px;cursor:help;font-weight:600;color:#fbbf24;position:relative;display:inline-block;">
                Hover for tooltip
                <span class="tooltip-content" style="display:none;position:absolute;bottom:calc(100% + 8px);left:50%;transform:translateX(-50%);background:#1e293b;color:white;padding:8px 14px;border-radius:8px;font-size:12px;white-space:nowrap;font-weight:400;z-index:100;">
                    This is a tooltip message!
                </span>
            </span>
            <span id="tooltipTarget2" class="tooltip-trigger" style="padding:10px 20px;background:rgba(5,150,105,0.1);border-radius:8px;cursor:help;font-weight:600;color:#34d399;position:relative;display:inline-block;">
                Hover for info
                <span class="tooltip-content" style="display:none;position:absolute;bottom:calc(100% + 8px);left:50%;transform:translateX(-50%);background:#1e293b;color:white;padding:8px 14px;border-radius:8px;font-size:12px;white-space:nowrap;font-weight:400;z-index:100;">
                    Additional information on hover
                </span>
            </span>
        </div>

        <h3>2b. Hover to Reveal Dropdown Menu</h3>
        <div id="hoverMenu" style="position:relative;display:inline-block;margin:8px 0;">
            <div id="hoverMenuTrigger" style="padding:12px 24px;background:linear-gradient(135deg,#7c3aed,#6d28d9);color:white;border-radius:10px;font-weight:600;cursor:pointer;font-size:14px;">
                Hover for Menu ▼
            </div>
            <div id="hoverMenuDropdown" style="display:none;position:absolute;top:100%;left:0;background:var(--bg-card);border:1px solid var(--border-default);border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.4);min-width:200px;z-index:100;margin-top:4px;">
                <div class="menu-item" onclick="hoverMenuSelect('Dashboard')" style="padding:10px 16px;cursor:pointer;font-size:14px;border-bottom:1px solid var(--border-subtle);color:var(--text-primary);transition:background 0.15s;">Dashboard</div>
                <div class="menu-item" onclick="hoverMenuSelect('Settings')" style="padding:10px 16px;cursor:pointer;font-size:14px;border-bottom:1px solid var(--border-subtle);color:var(--text-primary);transition:background 0.15s;">Settings</div>
                <div class="menu-item" onclick="hoverMenuSelect('Profile')" style="padding:10px 16px;cursor:pointer;font-size:14px;border-bottom:1px solid var(--border-subtle);color:var(--text-primary);transition:background 0.15s;">Profile</div>
                <div class="menu-item" onclick="hoverMenuSelect('Logout')" style="padding:10px 16px;cursor:pointer;font-size:14px;color:#f87171;transition:background 0.15s;">Logout</div>
            </div>
        </div>

        <h3>2c. Hover State Changes</h3>
        <div style="display:flex;gap:12px;flex-wrap:wrap;margin:8px 0;">
            <div id="hoverCard1" style="width:140px;padding:16px;background:var(--bg-secondary);border:2px solid var(--border-default);border-radius:10px;text-align:center;cursor:pointer;transition:all 0.3s;">
                <div style="font-size:24px;margin-bottom:4px;">&#9744;</div>
                <div style="font-weight:600;font-size:13px;color:var(--text-primary);">Item 1</div>
                <div style="font-size:11px;color:var(--text-muted);margin-top:2px;">Hover to highlight</div>
            </div>
            <div id="hoverCard2" style="width:140px;padding:16px;background:var(--bg-secondary);border:2px solid var(--border-default);border-radius:10px;text-align:center;cursor:pointer;transition:all 0.3s;">
                <div style="font-size:24px;margin-bottom:4px;">&#9881;</div>
                <div style="font-weight:600;font-size:13px;color:var(--text-primary);">Item 2</div>
                <div style="font-size:11px;color:var(--text-muted);margin-top:2px;">Hover to highlight</div>
            </div>
            <div id="hoverCard3" style="width:140px;padding:16px;background:var(--bg-secondary);border:2px solid var(--border-default);border-radius:10px;text-align:center;cursor:pointer;transition:all 0.3s;">
                <div style="font-size:24px;margin-bottom:4px;">&#9670;</div>
                <div style="font-weight:600;font-size:13px;color:var(--text-primary);">Item 3</div>
                <div style="font-size:11px;color:var(--text-muted);margin-top:2px;">Hover to highlight</div>
            </div>
        </div>

        <h3>2d. Hover to Reveal Hidden Actions</h3>
        <div id="hoverRevealRow" style="display:flex;align-items:center;justify-content:space-between;padding:14px 20px;background:var(--bg-secondary);border:1px solid var(--border-default);border-radius:10px;margin:8px 0;cursor:pointer;">
            <span style="font-weight:600;color:var(--text-primary);">Row Item — hover to reveal action buttons</span>
            <div id="hoverActions" style="display:none;gap:8px;">
                <button onclick="recordClick('editBtn','Edit clicked')" style="padding:6px 14px;font-size:12px;margin:0;background:linear-gradient(135deg,#2563eb,#1d4ed8);box-shadow:0 1px 4px rgba(37,99,235,0.3);">Edit</button>
                <button onclick="recordClick('deleteBtn','Delete clicked')" style="padding:6px 14px;font-size:12px;margin:0;background:linear-gradient(135deg,#dc2626,#b91c1c);box-shadow:0 1px 4px rgba(220,38,38,0.3);">Delete</button>
            </div>
        </div>

        <div class="result-box" id="hoverResult">Hover interactions will appear here</div>
    </div>

    <!-- ===== Section 3: Drag and Drop ===== -->
    <div class="section-card">
        <div class="section-card-header"><h2>Section 3: Drag and Drop</h2></div>
        <span class="tag tag-drag">drag-drop</span>
        <p>Drag items between zones, sortable list, and drag-to-set values.</p>

        <h3>3a. Drag Between Zones</h3>
        <div style="display:flex;gap:20px;flex-wrap:wrap;margin:8px 0;">
            <div id="dragSource" style="flex:1;min-width:200px;min-height:140px;padding:14px;background:rgba(37,99,235,0.06);border:2px dashed rgba(96,165,250,0.4);border-radius:10px;">
                <div style="font-weight:600;font-size:13px;color:#60a5fa;margin-bottom:8px;">Source Zone</div>
                <div class="draggable-item" draggable="true" data-id="item1" style="padding:10px 14px;background:var(--bg-secondary);border:1px solid var(--border-default);border-radius:8px;margin:4px 0;cursor:grab;font-size:13px;color:var(--text-primary);">Drag Item A</div>
                <div class="draggable-item" draggable="true" data-id="item2" style="padding:10px 14px;background:var(--bg-secondary);border:1px solid var(--border-default);border-radius:8px;margin:4px 0;cursor:grab;font-size:13px;color:var(--text-primary);">Drag Item B</div>
                <div class="draggable-item" draggable="true" data-id="item3" style="padding:10px 14px;background:var(--bg-secondary);border:1px solid var(--border-default);border-radius:8px;margin:4px 0;cursor:grab;font-size:13px;color:var(--text-primary);">Drag Item C</div>
            </div>
            <div id="dragTarget" style="flex:1;min-width:200px;min-height:140px;padding:14px;background:rgba(251,191,36,0.06);border:2px dashed rgba(251,191,36,0.4);border-radius:10px;">
                <div style="font-weight:600;font-size:13px;color:#fbbf24;margin-bottom:8px;">Drop Zone</div>
                <div id="dropPlaceholder" style="padding:10px;text-align:center;color:#fbbf24;font-size:12px;border:1px dashed rgba(251,191,36,0.4);border-radius:6px;">Drop items here</div>
            </div>
        </div>

        <h3>3b. Sortable List</h3>
        <div id="sortableList" style="max-width:360px;margin:8px 0;">
            <div class="sortable-item" draggable="true" data-order="1" style="padding:12px 16px;background:var(--bg-secondary);border:1px solid var(--border-default);border-radius:8px;margin:4px 0;cursor:grab;font-size:14px;display:flex;align-items:center;gap:10px;color:var(--text-primary);">
                <span style="color:var(--text-muted);font-size:18px;">&#10247;</span> <span>First item</span>
            </div>
            <div class="sortable-item" draggable="true" data-order="2" style="padding:12px 16px;background:var(--bg-secondary);border:1px solid var(--border-default);border-radius:8px;margin:4px 0;cursor:grab;font-size:14px;display:flex;align-items:center;gap:10px;color:var(--text-primary);">
                <span style="color:var(--text-muted);font-size:18px;">&#10247;</span> <span>Second item</span>
            </div>
            <div class="sortable-item" draggable="true" data-order="3" style="padding:12px 16px;background:var(--bg-secondary);border:1px solid var(--border-default);border-radius:8px;margin:4px 0;cursor:grab;font-size:14px;display:flex;align-items:center;gap:10px;color:var(--text-primary);">
                <span style="color:var(--text-muted);font-size:18px;">&#10247;</span> <span>Third item</span>
            </div>
            <div class="sortable-item" draggable="true" data-order="4" style="padding:12px 16px;background:var(--bg-secondary);border:1px solid var(--border-default);border-radius:8px;margin:4px 0;cursor:grab;font-size:14px;display:flex;align-items:center;gap:10px;color:var(--text-primary);">
                <span style="color:var(--text-muted);font-size:18px;">&#10247;</span> <span>Fourth item</span>
            </div>
        </div>

        <h3>3c. Drag Slider</h3>
        <label for="dragSlider">Volume (drag handle)</label>
        <input type="range" id="dragSlider" min="0" max="100" value="50" style="max-width:360px;cursor:grab;">
        <div class="counter" id="sliderValue">Value: 50</div>

        <div class="result-box" id="dragResult">Drag interactions will appear here</div>
    </div>

    <!-- ===== Section 4: Scroll Interactions ===== -->
    <div class="section-card">
        <div class="section-card-header"><h2>Section 4: Scroll Interactions</h2></div>
        <span class="tag tag-scroll">scroll</span>
        <p>Scrollable containers, scroll-to-element, infinite scroll, and scroll-triggered content.</p>

        <h3>4a. Scrollable Container</h3>
        <div id="scrollContainer" style="max-height:200px;overflow-y:auto;border:1px solid var(--border-default);border-radius:10px;padding:8px;margin:8px 0;">
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 1 — Scroll down to find the target</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 2</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 3</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 4</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 5</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 6</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 7</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 8</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 9</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 10</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 11</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 12</div>
            <div id="scrollTarget" style="padding:16px;background:rgba(5,150,105,0.1);border-radius:8px;font-weight:600;color:#34d399;">Target: You found me by scrolling!</div>
            <div style="padding:12px;border-bottom:1px solid var(--border-subtle);color:var(--text-secondary);">Row 14</div>
            <div style="padding:12px;color:var(--text-secondary);">Row 15 (last)</div>
        </div>
        <div class="counter" id="scrollPosition">Scroll position: 0px</div>

        <h3>4b. Scroll-to-Element Buttons</h3>
        <button onclick="scrollToTarget('scrollTarget')" style="font-size:12px;padding:8px 16px;">Scroll to Target (Green)</button>
        <button onclick="scrollToTarget('section7')" style="font-size:12px;padding:8px 16px;">Scroll to Section 7</button>

        <h3>4c. Lazy-Load on Scroll</h3>
        <div id="lazyScrollContainer" style="max-height:180px;overflow-y:auto;border:1px solid var(--border-default);border-radius:10px;padding:8px;margin:8px 0;">
            <div id="lazyItems"></div>
            <div id="lazyLoader" style="padding:16px;text-align:center;color:var(--text-muted);font-size:13px;">Scroll down to load more...</div>
        </div>
        <div class="counter" id="lazyCount">Loaded items: 5</div>

        <div class="result-box" id="scrollResult">Scroll interactions will appear here</div>
    </div>

    <!-- ===== Section 5: Keyboard Shortcuts ===== -->
    <div class="section-card">
        <div class="section-card-header"><h2>Section 5: Keyboard Shortcuts & Key Combinations</h2></div>
        <span class="tag tag-key">keyboard</span>
        <p>Ctrl+A, Ctrl+C/V, Enter, Tab, Escape, Arrow keys, and other keyboard interactions.</p>

        <h3>5a. Select All + Copy/Paste</h3>
        <label for="copySource">Source (Ctrl+A to select all, Ctrl+C to copy)</label>
        <input type="text" id="copySource" value="Copy this text to the target field">
        <label for="pasteTarget">Target (Ctrl+V to paste)</label>
        <input type="text" id="pasteTarget" placeholder="Paste here with Ctrl+V">

        <h3>5b. Clear and Retype</h3>
        <label for="clearRetype">Pre-filled field (Ctrl+A → Delete → Type new value)</label>
        <input type="text" id="clearRetype" value="Old value - clear me and type new">

        <h3>5c. Enter Key to Submit</h3>
        <label for="enterSubmit">Type and press Enter to submit</label>
        <input type="text" id="enterSubmit" placeholder="Press Enter when done">
        <div id="enterResult" style="margin:4px 0;font-size:13px;color:#34d399;font-weight:600;"></div>

        <h3>5d. Escape Key to Cancel</h3>
        <button id="openModal" onclick="showModal()">Open Modal (press Escape to close)</button>
        <div id="escModal" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);z-index:9999;display:none;align-items:center;justify-content:center;">
            <div style="background:var(--bg-card);padding:30px;border-radius:16px;max-width:400px;width:90%;text-align:center;box-shadow:0 8px 32px rgba(0,0,0,0.5);border:1px solid var(--border-default);">
                <h3 style="margin-bottom:12px;color:var(--text-primary);">Modal Dialog</h3>
                <p style="font-size:14px;margin-bottom:16px;">Press <code>Escape</code> to close this modal, or click the button.</p>
                <input type="text" id="modalInput" placeholder="Type inside modal" style="margin-bottom:12px;">
                <br>
                <button onclick="hideModal()">Close Modal</button>
            </div>
        </div>

        <h3>5e. Arrow Keys Navigation</h3>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin:8px 0;" id="arrowGrid">
            <div class="arrow-cell" data-index="0" tabindex="0" style="width:50px;height:50px;background:var(--bg-secondary);border:2px solid var(--border-default);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:600;cursor:pointer;transition:all 0.15s;color:var(--text-primary);">1</div>
            <div class="arrow-cell" data-index="1" tabindex="0" style="width:50px;height:50px;background:var(--bg-secondary);border:2px solid var(--border-default);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:600;cursor:pointer;transition:all 0.15s;color:var(--text-primary);">2</div>
            <div class="arrow-cell" data-index="2" tabindex="0" style="width:50px;height:50px;background:var(--bg-secondary);border:2px solid var(--border-default);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:600;cursor:pointer;transition:all 0.15s;color:var(--text-primary);">3</div>
            <div class="arrow-cell" data-index="3" tabindex="0" style="width:50px;height:50px;background:var(--bg-secondary);border:2px solid var(--border-default);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:600;cursor:pointer;transition:all 0.15s;color:var(--text-primary);">4</div>
            <div class="arrow-cell" data-index="4" tabindex="0" style="width:50px;height:50px;background:var(--bg-secondary);border:2px solid var(--border-default);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:600;cursor:pointer;transition:all 0.15s;color:var(--text-primary);">5</div>
        </div>
        <div class="counter" id="arrowSelected">Selected: none (click a cell, then use arrow keys)</div>

        <h3>5f. Tab Navigation</h3>
        <label for="tabField1">Field 1 (Tab to next)</label>
        <input type="text" id="tabField1" placeholder="Tab from here →">
        <label for="tabField2">Field 2 (Tab to next)</label>
        <input type="text" id="tabField2" placeholder="→ to here → Tab again">
        <label for="tabField3">Field 3 (Shift+Tab to go back)</label>
        <input type="text" id="tabField3" placeholder="→ to here (Shift+Tab goes back)">

        <div class="result-box" id="keyResult">Keyboard interactions will appear here</div>
    </div>

    <!-- ===== Section 6: File Upload ===== -->
    <div class="section-card">
        <div class="section-card-header"><h2>Section 6: File Upload</h2></div>
        <span class="tag tag-file">file-upload</span>
        <p>File input browse, drag-and-drop file upload zone, and multi-file upload.</p>

        <h3>6a. Standard File Input</h3>
        <label for="fileInput">Choose file (browse button)</label>
        <input type="file" id="fileInput" accept="image/*,.pdf,.txt" style="border:none;padding:0;">

        <h3>6b. Multi-File Input</h3>
        <label for="multiFileInput">Choose multiple files</label>
        <input type="file" id="multiFileInput" multiple accept="*/*" style="border:none;padding:0;">

        <h3>6c. Drag-and-Drop Upload Zone</h3>
        <div id="dropZone" style="padding:40px 20px;background:var(--bg-secondary);border:2px dashed var(--border-default);border-radius:12px;text-align:center;cursor:pointer;margin:8px 0;transition:all 0.2s;">
            <div style="font-size:32px;margin-bottom:8px;">&#128193;</div>
            <div style="font-weight:600;color:var(--text-secondary);">Drag files here or click to browse</div>
            <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Supports any file type</div>
            <input type="file" id="dropZoneInput" multiple style="display:none;">
        </div>
        <div id="fileList" style="margin:8px 0;"></div>

        <div class="result-box" id="fileResult">File upload interactions will appear here</div>
    </div>

    <!-- ===== Section 7: Date & Time Pickers ===== -->
    <div class="section-card" id="section7">
        <div class="section-card-header"><h2>Section 7: Date & Time Pickers</h2></div>
        <span class="tag tag-click">date-time</span>
        <p>Native date, time, datetime-local, month, week inputs — all require click/interaction beyond typing.</p>

        <label for="dateInput">Date</label>
        <input type="date" id="dateInput">

        <label for="timeInput">Time</label>
        <input type="time" id="timeInput">

        <label for="datetimeInput">Date & Time</label>
        <input type="datetime-local" id="datetimeInput">

        <label for="monthInput">Month</label>
        <input type="month" id="monthInput">

        <label for="weekInput">Week</label>
        <input type="week" id="weekInput">

        <label for="colorInput">Color Picker</label>
        <input type="color" id="colorInput" value="#0ea5e9" style="width:60px;height:40px;padding:4px;cursor:pointer;">

        <div class="result-box" id="dateResult">Date/time selections will appear here</div>
    </div>

    <!-- ===== Section 8: Select & Multi-Select ===== -->
    <div class="section-card">
        <div class="section-card-header"><h2>Section 8: Select, Multi-Select & Combobox</h2></div>
        <span class="tag tag-click">select</span>
        <p>Standard dropdowns, multi-select, searchable select, and cascading/dependent dropdowns.</p>

        <h3>8a. Standard Select</h3>
        <label for="stdSelect">Choose one</label>
        <select id="stdSelect">
            <option value="">Select an option...</option>
            <option value="opt1">Option 1 — Alpha</option>
            <option value="opt2">Option 2 — Beta</option>
            <option value="opt3">Option 3 — Gamma</option>
            <option value="opt4">Option 4 — Delta</option>
        </select>

        <h3>8b. Multi-Select (hold Ctrl/Cmd)</h3>
        <label for="multiSelect">Choose multiple (Ctrl+Click)</label>
        <select id="multiSelect" multiple size="5" style="height:auto;">
            <option value="js">JavaScript</option>
            <option value="py">Python</option>
            <option value="java">Java</option>
            <option value="go">Go</option>
            <option value="rust">Rust</option>
            <option value="ts">TypeScript</option>
        </select>

        <h3>8c. Dependent/Cascading Dropdowns</h3>
        <label for="countrySelect">Country</label>
        <select id="countrySelect">
            <option value="">Select country...</option>
            <option value="us">United States</option>
            <option value="in">India</option>
            <option value="uk">United Kingdom</option>
        </select>
        <label for="citySelect">City (depends on country)</label>
        <select id="citySelect" disabled>
            <option value="">Select country first...</option>
        </select>

        <h3>8d. Searchable Input with Datalist</h3>
        <label for="searchSelect">Search and select (type to filter)</label>
        <input type="text" id="searchSelect" list="searchOptions" placeholder="Start typing...">
        <datalist id="searchOptions">
            <option value="New York">
            <option value="Los Angeles">
            <option value="Chicago">
            <option value="Houston">
            <option value="Phoenix">
            <option value="San Francisco">
            <option value="Mumbai">
            <option value="London">
            <option value="Berlin">
            <option value="Tokyo">
        </datalist>

        <div class="result-box" id="selectResult">Select interactions will appear here</div>
    </div>

    <!-- ===== Section 9: Checkbox, Radio & Toggle ===== -->
    <div class="section-card">
        <div class="section-card-header"><h2>Section 9: Checkbox, Radio & Toggle</h2></div>
        <span class="tag tag-click">toggle</span>
        <p>Checkboxes (single, group, select-all), radio buttons, and custom toggle switches.</p>

        <h3>9a. Checkbox Group with Select All</h3>
        <label style="color:var(--accent);"><input type="checkbox" id="selectAll"> <strong>Select All</strong></label>
        <div style="margin-left:20px;">
            <label><input type="checkbox" class="perm-cb" value="read"> Read</label>
            <label><input type="checkbox" class="perm-cb" value="write"> Write</label>
            <label><input type="checkbox" class="perm-cb" value="delete"> Delete</label>
            <label><input type="checkbox" class="perm-cb" value="admin"> Admin</label>
        </div>

        <h3>9b. Radio Button Group</h3>
        <div style="margin:8px 0;">
            <label><input type="radio" name="priority" value="low"> Low Priority</label>
            <label><input type="radio" name="priority" value="medium" checked> Medium Priority</label>
            <label><input type="radio" name="priority" value="high"> High Priority</label>
            <label><input type="radio" name="priority" value="critical"> Critical Priority</label>
        </div>

        <h3>9c. Custom Toggle Switches</h3>
        <div style="display:flex;flex-direction:column;gap:12px;margin:12px 0;">
            <div class="toggle-row" style="display:flex;align-items:center;gap:12px;">
                <div class="custom-toggle" id="toggle1" onclick="toggleSwitch('toggle1')" style="width:48px;height:26px;border-radius:13px;background:#52525b;position:relative;cursor:pointer;transition:background 0.2s;">
                    <div style="width:22px;height:22px;border-radius:50%;background:white;position:absolute;top:2px;left:2px;transition:transform 0.2s;box-shadow:0 1px 3px rgba(0,0,0,0.3);"></div>
                </div>
                <span style="font-weight:600;font-size:14px;color:var(--text-primary);">Dark Mode</span>
            </div>
            <div class="toggle-row" style="display:flex;align-items:center;gap:12px;">
                <div class="custom-toggle" id="toggle2" onclick="toggleSwitch('toggle2')" style="width:48px;height:26px;border-radius:13px;background:#52525b;position:relative;cursor:pointer;transition:background 0.2s;">
                    <div style="width:22px;height:22px;border-radius:50%;background:white;position:absolute;top:2px;left:2px;transition:transform 0.2s;box-shadow:0 1px 3px rgba(0,0,0,0.3);"></div>
                </div>
                <span style="font-weight:600;font-size:14px;color:var(--text-primary);">Email Notifications</span>
            </div>
            <div class="toggle-row" style="display:flex;align-items:center;gap:12px;">
                <div class="custom-toggle" id="toggle3" onclick="toggleSwitch('toggle3')" style="width:48px;height:26px;border-radius:13px;background:#52525b;position:relative;cursor:pointer;transition:background 0.2s;">
                    <div style="width:22px;height:22px;border-radius:50%;background:white;position:absolute;top:2px;left:2px;transition:transform 0.2s;box-shadow:0 1px 3px rgba(0,0,0,0.3);"></div>
                </div>
                <span style="font-weight:600;font-size:14px;color:var(--text-primary);">Auto-save</span>
            </div>
        </div>

        <div class="result-box" id="toggleResult">Toggle/checkbox/radio interactions will appear here</div>
    </div>

    <!-- ===== Section 10: Contenteditable & Rich Text ===== -->
    <div class="section-card">
        <div class="section-card-header"><h2>Section 10: Contenteditable & Rich Text</h2></div>
        <span class="tag tag-key">contenteditable</span>
        <p>Editable divs, rich text areas, and inline editing — not standard <code>&lt;input&gt;</code> elements.</p>

        <h3>10a. Contenteditable Div</h3>
        <div id="editableDiv" contenteditable="true" style="padding:14px;min-height:60px;background:var(--bg-input);border:1.5px solid var(--border-default);border-radius:10px;font-size:14px;outline:none;margin:8px 0;line-height:1.6;color:var(--text-primary);" data-placeholder="Type here — this is a contenteditable div, not an input!">
        </div>

        <h3>10b. Inline Editable Text</h3>
        <p style="font-size:14px;">
            Click the highlighted text to edit:
            <span id="inlineEdit" contenteditable="true" style="background:rgba(251,191,36,0.15);padding:2px 8px;border-radius:4px;cursor:text;outline:none;font-weight:600;color:#fbbf24;">editable inline text</span>
        </p>

        <h3>10c. Rich Text Toolbar</h3>
        <div style="border:1px solid var(--border-default);border-radius:10px;overflow:hidden;margin:8px 0;">
            <div style="display:flex;gap:2px;padding:8px;background:var(--bg-secondary);border-bottom:1px solid var(--border-default);">
                <button onclick="execRichCmd('bold')" style="padding:4px 10px;font-size:12px;margin:0;min-width:32px;background:rgba(255,255,255,0.06);color:var(--text-secondary);box-shadow:none;" title="Bold"><b>B</b></button>
                <button onclick="execRichCmd('italic')" style="padding:4px 10px;font-size:12px;margin:0;min-width:32px;background:rgba(255,255,255,0.06);color:var(--text-secondary);box-shadow:none;" title="Italic"><i>I</i></button>
                <button onclick="execRichCmd('underline')" style="padding:4px 10px;font-size:12px;margin:0;min-width:32px;background:rgba(255,255,255,0.06);color:var(--text-secondary);box-shadow:none;" title="Underline"><u>U</u></button>
                <button onclick="execRichCmd('insertUnorderedList')" style="padding:4px 10px;font-size:12px;margin:0;min-width:32px;background:rgba(255,255,255,0.06);color:var(--text-secondary);box-shadow:none;" title="List">&#9776;</button>
            </div>
            <div id="richTextEditor" contenteditable="true" style="padding:14px;min-height:80px;font-size:14px;outline:none;line-height:1.6;color:var(--text-primary);">
                Type rich text here. Use the toolbar buttons or Ctrl+B, Ctrl+I, Ctrl+U.
            </div>
        </div>

        <div class="result-box" id="editableResult">Contenteditable interactions will appear here</div>
    </div>

</main>

<footer class="site-footer">
    All Interaction Types &mdash; KaneAI SmartWait Test Suite
</footer>

<script>
// ===== Section 1: Clicks =====
var toggleState = false;
function recordClick(id, msg) {
    var result = document.getElementById('clickResult');
    result.textContent = '[' + new Date().toLocaleTimeString() + '] ' + msg + ' (element: #' + id + ')';
    result.classList.add('updated');
    setTimeout(function() { result.classList.remove('updated'); }, 300);

    if (id === 'singleClickBtn2') {
        toggleState = !toggleState;
        document.getElementById('singleClickState').textContent = 'State: ' + (toggleState ? 'ON' : 'OFF');
        document.getElementById('singleClickState').style.color = toggleState ? '#059669' : '#dc2626';
    }
}

// Double-click to edit
var dblTarget = document.getElementById('dblClickTarget');
var dblInput = document.getElementById('dblClickInput');
dblTarget.addEventListener('dblclick', function() {
    dblInput.value = dblTarget.textContent.trim();
    dblTarget.style.display = 'none';
    dblInput.style.display = 'block';
    dblInput.focus();
});
dblInput.addEventListener('blur', function() { finishDblEdit(); });
dblInput.addEventListener('keydown', function(e) { if (e.key === 'Enter') finishDblEdit(); });
function finishDblEdit() {
    dblTarget.textContent = dblInput.value || 'Double-click me to edit';
    dblTarget.style.display = 'block';
    dblInput.style.display = 'none';
    document.getElementById('clickResult').textContent = 'Double-click edit: "' + dblTarget.textContent + '"';
}

// Right-click context menu
var ctxMenu = document.getElementById('customContextMenu');
document.getElementById('rightClickTarget').addEventListener('contextmenu', function(e) {
    e.preventDefault();
    ctxMenu.style.display = 'block';
    ctxMenu.style.left = e.pageX + 'px';
    ctxMenu.style.top = e.pageY + 'px';
});
document.addEventListener('click', function() { ctxMenu.style.display = 'none'; });
function ctxAction(action) {
    document.getElementById('clickResult').textContent = 'Context menu action: ' + action;
    ctxMenu.style.display = 'none';
}

// Long press
var lpTarget = document.getElementById('longPressTarget');
var lpTimer, lpStart, lpInterval;
lpTarget.addEventListener('mousedown', function() {
    lpStart = Date.now();
    lpTarget.style.background = '#93c5fd';
    lpTarget.style.transform = 'scale(0.98)';
    lpInterval = setInterval(function() {
        document.getElementById('longPressTimer').textContent = 'Hold duration: ' + (Date.now() - lpStart) + 'ms';
    }, 50);
    lpTimer = setTimeout(function() {
        lpTarget.style.background = '#d1fae5';
        lpTarget.textContent = 'Long press detected!';
        document.getElementById('clickResult').textContent = 'Long press completed: ' + (Date.now() - lpStart) + 'ms';
    }, 1000);
});
lpTarget.addEventListener('mouseup', function() {
    clearTimeout(lpTimer);
    clearInterval(lpInterval);
    lpTarget.style.transform = 'scale(1)';
    if (Date.now() - lpStart < 1000) {
        lpTarget.style.background = '#dbeafe';
        document.getElementById('longPressTimer').textContent = 'Hold duration: ' + (Date.now() - lpStart) + 'ms (too short — need 1000ms)';
    }
});

// ===== Section 2: Hover =====
document.querySelectorAll('.tooltip-trigger').forEach(function(el) {
    el.addEventListener('mouseenter', function() {
        el.querySelector('.tooltip-content').style.display = 'block';
        document.getElementById('hoverResult').textContent = 'Tooltip visible on #' + el.id;
    });
    el.addEventListener('mouseleave', function() {
        el.querySelector('.tooltip-content').style.display = 'none';
    });
});

var hoverMenu = document.getElementById('hoverMenu');
hoverMenu.addEventListener('mouseenter', function() {
    document.getElementById('hoverMenuDropdown').style.display = 'block';
});
hoverMenu.addEventListener('mouseleave', function() {
    document.getElementById('hoverMenuDropdown').style.display = 'none';
});
function hoverMenuSelect(item) {
    document.getElementById('hoverResult').textContent = 'Menu selected: ' + item;
    document.getElementById('hoverMenuDropdown').style.display = 'none';
}

['hoverCard1', 'hoverCard2', 'hoverCard3'].forEach(function(id) {
    var card = document.getElementById(id);
    card.addEventListener('mouseenter', function() {
        card.style.borderColor = '#e11d48';
        card.style.background = '#fff1f2';
        card.style.transform = 'translateY(-2px)';
        document.getElementById('hoverResult').textContent = 'Hovering: #' + id;
    });
    card.addEventListener('mouseleave', function() {
        card.style.borderColor = '#e2e8f0';
        card.style.background = '#f8fafc';
        card.style.transform = 'translateY(0)';
    });
});

var revealRow = document.getElementById('hoverRevealRow');
revealRow.addEventListener('mouseenter', function() {
    document.getElementById('hoverActions').style.display = 'flex';
});
revealRow.addEventListener('mouseleave', function() {
    document.getElementById('hoverActions').style.display = 'none';
});

// ===== Section 3: Drag and Drop =====
var draggedItem = null;
document.querySelectorAll('.draggable-item').forEach(function(item) {
    item.addEventListener('dragstart', function(e) {
        draggedItem = item;
        item.style.opacity = '0.5';
        e.dataTransfer.effectAllowed = 'move';
    });
    item.addEventListener('dragend', function() {
        item.style.opacity = '1';
        draggedItem = null;
    });
});

var dragTarget = document.getElementById('dragTarget');
dragTarget.addEventListener('dragover', function(e) {
    e.preventDefault();
    dragTarget.style.background = '#fef9c3';
    dragTarget.style.borderColor = '#f59e0b';
});
dragTarget.addEventListener('dragleave', function() {
    dragTarget.style.background = '#fef3c7';
    dragTarget.style.borderColor = '#fbbf24';
});
dragTarget.addEventListener('drop', function(e) {
    e.preventDefault();
    dragTarget.style.background = '#fef3c7';
    dragTarget.style.borderColor = '#fbbf24';
    if (draggedItem) {
        var placeholder = document.getElementById('dropPlaceholder');
        if (placeholder) placeholder.remove();
        dragTarget.appendChild(draggedItem);
        document.getElementById('dragResult').textContent = 'Dropped: ' + draggedItem.textContent + ' into target zone';
    }
});

// Sortable
var sortableList = document.getElementById('sortableList');
sortableList.addEventListener('dragover', function(e) { e.preventDefault(); });
sortableList.addEventListener('drop', function(e) {
    e.preventDefault();
    var target = e.target.closest('.sortable-item');
    if (target && draggedItem && target !== draggedItem) {
        var items = Array.from(sortableList.children);
        var dragIdx = items.indexOf(draggedItem);
        var targetIdx = items.indexOf(target);
        if (dragIdx < targetIdx) {
            sortableList.insertBefore(draggedItem, target.nextSibling);
        } else {
            sortableList.insertBefore(draggedItem, target);
        }
        document.getElementById('dragResult').textContent = 'Reordered: moved item from position ' + (dragIdx + 1) + ' to ' + (targetIdx + 1);
    }
});
document.querySelectorAll('.sortable-item').forEach(function(item) {
    item.addEventListener('dragstart', function(e) {
        draggedItem = item;
        item.style.opacity = '0.5';
    });
    item.addEventListener('dragend', function() { item.style.opacity = '1'; draggedItem = null; });
});

// Slider
document.getElementById('dragSlider').addEventListener('input', function(e) {
    document.getElementById('sliderValue').textContent = 'Value: ' + e.target.value;
    document.getElementById('dragResult').textContent = 'Slider dragged to: ' + e.target.value;
});

// ===== Section 4: Scroll =====
var scrollContainer = document.getElementById('scrollContainer');
scrollContainer.addEventListener('scroll', function() {
    document.getElementById('scrollPosition').textContent = 'Scroll position: ' + Math.round(scrollContainer.scrollTop) + 'px';
    var target = document.getElementById('scrollTarget');
    var rect = target.getBoundingClientRect();
    var containerRect = scrollContainer.getBoundingClientRect();
    if (rect.top >= containerRect.top && rect.bottom <= containerRect.bottom) {
        document.getElementById('scrollResult').textContent = 'Scroll target is now visible!';
    }
});

function scrollToTarget(id) {
    document.getElementById(id).scrollIntoView({ behavior: 'smooth', block: 'center' });
    document.getElementById('scrollResult').textContent = 'Scrolled to #' + id;
}

// Lazy load
var lazyContainer = document.getElementById('lazyScrollContainer');
var lazyItemsEl = document.getElementById('lazyItems');
var lazyItemCount = 0;
function addLazyItems(count) {
    for (var i = 0; i < count; i++) {
        lazyItemCount++;
        var div = document.createElement('div');
        div.style.cssText = 'padding:12px;border-bottom:1px solid #f1f5f9;font-size:14px;';
        div.textContent = 'Lazy item #' + lazyItemCount;
        lazyItemsEl.appendChild(div);
    }
    document.getElementById('lazyCount').textContent = 'Loaded items: ' + lazyItemCount;
}
addLazyItems(5);
lazyContainer.addEventListener('scroll', function() {
    if (lazyContainer.scrollTop + lazyContainer.clientHeight >= lazyContainer.scrollHeight - 20) {
        addLazyItems(5);
        document.getElementById('scrollResult').textContent = 'Lazy loaded more items (total: ' + lazyItemCount + ')';
    }
});

// ===== Section 5: Keyboard =====
document.getElementById('pasteTarget').addEventListener('paste', function(e) {
    setTimeout(function() {
        document.getElementById('keyResult').textContent = 'Pasted into target: "' + document.getElementById('pasteTarget').value + '"';
    }, 10);
});
document.getElementById('copySource').addEventListener('copy', function() {
    document.getElementById('keyResult').textContent = 'Copied from source: "' + document.getElementById('copySource').value + '"';
});

document.getElementById('enterSubmit').addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
        e.preventDefault();
        document.getElementById('enterResult').textContent = 'Submitted: "' + e.target.value + '"';
        document.getElementById('keyResult').textContent = 'Enter key submitted: "' + e.target.value + '"';
    }
});

function showModal() {
    document.getElementById('escModal').style.display = 'flex';
    setTimeout(function() { document.getElementById('modalInput').focus(); }, 100);
}
function hideModal() {
    document.getElementById('escModal').style.display = 'none';
    document.getElementById('keyResult').textContent = 'Modal closed';
}
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && document.getElementById('escModal').style.display === 'flex') {
        hideModal();
        document.getElementById('keyResult').textContent = 'Modal closed via Escape key';
    }
});

// Arrow keys
var arrowCells = document.querySelectorAll('.arrow-cell');
var currentArrow = -1;
arrowCells.forEach(function(cell, idx) {
    cell.addEventListener('click', function() {
        arrowCells.forEach(function(c) { c.style.borderColor = '#e2e8f0'; c.style.background = '#f1f5f9'; });
        cell.style.borderColor = '#e11d48';
        cell.style.background = '#fee2e2';
        currentArrow = idx;
        cell.focus();
        document.getElementById('arrowSelected').textContent = 'Selected: Cell ' + (idx + 1);
    });
    cell.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' && currentArrow < arrowCells.length - 1) {
            e.preventDefault();
            arrowCells[currentArrow + 1].click();
        } else if (e.key === 'ArrowLeft' && currentArrow > 0) {
            e.preventDefault();
            arrowCells[currentArrow - 1].click();
        }
    });
});

// Tab tracking
['tabField1', 'tabField2', 'tabField3'].forEach(function(id) {
    document.getElementById(id).addEventListener('focus', function() {
        document.getElementById('keyResult').textContent = 'Tab focused: #' + id;
    });
});

// ===== Section 6: File Upload =====
document.getElementById('fileInput').addEventListener('change', function(e) {
    var f = e.target.files[0];
    document.getElementById('fileResult').textContent = f ? 'File selected: ' + f.name + ' (' + (f.size / 1024).toFixed(1) + 'KB)' : 'No file';
});
document.getElementById('multiFileInput').addEventListener('change', function(e) {
    var names = Array.from(e.target.files).map(function(f) { return f.name; }).join(', ');
    document.getElementById('fileResult').textContent = 'Files selected: ' + names + ' (' + e.target.files.length + ' files)';
});

var dropZone = document.getElementById('dropZone');
dropZone.addEventListener('click', function() { document.getElementById('dropZoneInput').click(); });
dropZone.addEventListener('dragover', function(e) { e.preventDefault(); dropZone.style.borderColor = '#e11d48'; dropZone.style.background = '#fff1f2'; });
dropZone.addEventListener('dragleave', function() { dropZone.style.borderColor = '#d2d6dc'; dropZone.style.background = '#f8fafc'; });
dropZone.addEventListener('drop', function(e) {
    e.preventDefault();
    dropZone.style.borderColor = '#d2d6dc';
    dropZone.style.background = '#f8fafc';
    var files = e.dataTransfer.files;
    showFileList(files);
});
document.getElementById('dropZoneInput').addEventListener('change', function(e) { showFileList(e.target.files); });
function showFileList(files) {
    var html = '';
    for (var i = 0; i < files.length; i++) {
        html += '<div style="padding:8px;background:#f1f5f9;border-radius:6px;margin:4px 0;font-size:13px;">' + files[i].name + ' (' + (files[i].size / 1024).toFixed(1) + 'KB)</div>';
    }
    document.getElementById('fileList').innerHTML = html;
    document.getElementById('fileResult').textContent = 'Dropped ' + files.length + ' file(s)';
}

// ===== Section 7: Date/Time =====
['dateInput', 'timeInput', 'datetimeInput', 'monthInput', 'weekInput', 'colorInput'].forEach(function(id) {
    document.getElementById(id).addEventListener('change', function(e) {
        document.getElementById('dateResult').textContent = id + ' changed to: ' + e.target.value;
    });
});

// ===== Section 8: Selects =====
document.getElementById('stdSelect').addEventListener('change', function(e) {
    document.getElementById('selectResult').textContent = 'Selected: ' + e.target.options[e.target.selectedIndex].text;
});
document.getElementById('multiSelect').addEventListener('change', function(e) {
    var selected = Array.from(e.target.selectedOptions).map(function(o) { return o.text; }).join(', ');
    document.getElementById('selectResult').textContent = 'Multi-selected: ' + selected;
});

var citiesByCountry = {
    us: ['New York', 'Los Angeles', 'Chicago', 'Houston'],
    in: ['Mumbai', 'Delhi', 'Bangalore', 'Chennai'],
    uk: ['London', 'Manchester', 'Birmingham', 'Leeds']
};
document.getElementById('countrySelect').addEventListener('change', function(e) {
    var citySelect = document.getElementById('citySelect');
    citySelect.innerHTML = '<option value="">Select city...</option>';
    var cities = citiesByCountry[e.target.value] || [];
    cities.forEach(function(city) {
        var opt = document.createElement('option');
        opt.value = city.toLowerCase().replace(/\s/g, '-');
        opt.textContent = city;
        citySelect.appendChild(opt);
    });
    citySelect.disabled = cities.length === 0;
    document.getElementById('selectResult').textContent = 'Country: ' + e.target.value + ' → ' + cities.length + ' cities loaded';
});
document.getElementById('citySelect').addEventListener('change', function(e) {
    document.getElementById('selectResult').textContent = 'City selected: ' + e.target.options[e.target.selectedIndex].text;
});

document.getElementById('searchSelect').addEventListener('input', function(e) {
    document.getElementById('selectResult').textContent = 'Search/datalist: ' + e.target.value;
});

// ===== Section 9: Toggles =====
document.getElementById('selectAll').addEventListener('change', function(e) {
    document.querySelectorAll('.perm-cb').forEach(function(cb) { cb.checked = e.target.checked; });
    document.getElementById('toggleResult').textContent = 'Select all: ' + (e.target.checked ? 'ALL checked' : 'ALL unchecked');
});
document.querySelectorAll('.perm-cb').forEach(function(cb) {
    cb.addEventListener('change', function() {
        var checked = Array.from(document.querySelectorAll('.perm-cb:checked')).map(function(c) { return c.value; });
        document.getElementById('toggleResult').textContent = 'Checked: ' + (checked.length > 0 ? checked.join(', ') : 'none');
        document.getElementById('selectAll').checked = checked.length === 4;
    });
});
document.querySelectorAll('input[name="priority"]').forEach(function(r) {
    r.addEventListener('change', function() {
        document.getElementById('toggleResult').textContent = 'Priority: ' + r.value;
    });
});

var toggleStates = {};
function toggleSwitch(id) {
    toggleStates[id] = !toggleStates[id];
    var el = document.getElementById(id);
    el.style.background = toggleStates[id] ? '#e11d48' : '#d2d6dc';
    el.querySelector('div').style.transform = toggleStates[id] ? 'translateX(22px)' : 'translateX(0)';
    var label = el.closest('.toggle-row').querySelector('span').textContent;
    document.getElementById('toggleResult').textContent = label + ': ' + (toggleStates[id] ? 'ON' : 'OFF');
}

// ===== Section 10: Contenteditable =====
document.getElementById('editableDiv').addEventListener('input', function(e) {
    document.getElementById('editableResult').textContent = 'Contenteditable: "' + e.target.textContent.substring(0, 80) + '"';
});
document.getElementById('inlineEdit').addEventListener('input', function(e) {
    document.getElementById('editableResult').textContent = 'Inline edit: "' + e.target.textContent + '"';
});
document.getElementById('richTextEditor').addEventListener('input', function(e) {
    document.getElementById('editableResult').textContent = 'Rich text: "' + e.target.textContent.substring(0, 80) + '"';
});
function execRichCmd(cmd) {
    document.execCommand(cmd, false, null);
    document.getElementById('richTextEditor').focus();
}

// ===== DOM Context Switcher =====
var DOM_PANEL_HTML = `
<style>
    .dp-label { font-weight: 600; display: block; margin-top: 14px; font-size: 14px; color: #4a5568; }
    .dp-input { padding: 10px 14px; width: 100%; max-width: 340px; margin: 6px 0; border: 1.5px solid #d2d6dc; border-radius: 10px; display: block; font-size: 14px; color: #2d3748; outline: none; box-sizing: border-box; }
    .dp-input:focus { border-color: #e11d48; box-shadow: 0 0 0 3px rgba(225,29,72,0.15); }
    .dp-textarea { padding: 10px 14px; width: 100%; max-width: 340px; margin: 6px 0; border: 1.5px solid #d2d6dc; border-radius: 10px; display: block; font-size: 14px; height: 60px; resize: vertical; color: #2d3748; outline: none; box-sizing: border-box; }
    .dp-textarea:focus { border-color: #e11d48; box-shadow: 0 0 0 3px rgba(225,29,72,0.15); }
    .dp-select { padding: 10px 14px; width: 100%; max-width: 340px; margin: 6px 0; border: 1.5px solid #d2d6dc; border-radius: 10px; display: block; font-size: 14px; color: #2d3748; outline: none; box-sizing: border-box; }
    .dp-btn { padding: 10px 20px; cursor: pointer; margin: 8px 8px 8px 0; background: linear-gradient(135deg, #e11d48, #be123c); color: white; border: none; border-radius: 10px; font-size: 14px; font-weight: 600; }
    .dp-btn:hover { opacity: 0.9; }
    .dp-btn-secondary { background: linear-gradient(135deg, #059669, #047857); }
    .dp-result { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 10px 14px; margin: 8px 0; font-family: monospace; font-size: 13px; }
    .dp-section { margin: 16px 0; padding: 16px; background: #f8fafc; border-radius: 10px; border: 1px solid #e2e8f0; }
    .dp-section-title { font-weight: 700; font-size: 14px; color: #1a202c; margin: 0 0 10px; }
    .dp-row { display: flex; align-items: center; gap: 10px; margin: 6px 0; }
    .dp-toggle { width: 44px; height: 24px; border-radius: 12px; background: #d2d6dc; position: relative; cursor: pointer; transition: background 0.2s; flex-shrink: 0; }
    .dp-toggle.on { background: #e11d48; }
    .dp-toggle-thumb { width: 20px; height: 20px; border-radius: 50%; background: white; position: absolute; top: 2px; left: 2px; transition: transform 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
    .dp-toggle.on .dp-toggle-thumb { transform: translateX(20px); }
    .dp-editable { padding: 10px 14px; min-height: 50px; background: white; border: 1.5px solid #d2d6dc; border-radius: 10px; font-size: 14px; outline: none; line-height: 1.5; }
    .dp-editable:focus { border-color: #e11d48; box-shadow: 0 0 0 3px rgba(225,29,72,0.15); }
    .dp-hover-zone { padding: 14px 20px; background: #fef3c7; border-radius: 8px; cursor: pointer; font-weight: 600; color: #92400e; text-align: center; position: relative; margin: 6px 0; }
    .dp-tooltip { display: none; position: absolute; bottom: calc(100% + 8px); left: 50%; transform: translateX(-50%); background: #1e293b; color: white; padding: 6px 12px; border-radius: 6px; font-size: 12px; white-space: nowrap; font-weight: 400; z-index: 10; }
    .dp-drag-item { padding: 10px 14px; background: white; border: 1px solid #e2e8f0; border-radius: 8px; margin: 4px 0; cursor: grab; font-size: 13px; }
    .dp-assert { color: #059669; font-weight: 600; font-size: 14px; margin: 4px 0; }
</style>
<div style="font-family: 'Segoe UI', system-ui, sans-serif;">

    <!-- Text Inputs -->
    <div class="dp-section">
        <div class="dp-section-title">Text Inputs</div>
        <label class="dp-label" for="dp-text">Full Name</label>
        <input class="dp-input" type="text" id="dp-text" placeholder="Type your name here">
        <label class="dp-label" for="dp-email">Email</label>
        <input class="dp-input" type="email" id="dp-email" placeholder="you@email.com">
        <label class="dp-label" for="dp-search">Search</label>
        <input class="dp-input" type="search" id="dp-search" placeholder="Search something...">
        <label class="dp-label" for="dp-password">Password</label>
        <input class="dp-input" type="password" id="dp-password" placeholder="Enter password">
        <label class="dp-label" for="dp-number">Quantity</label>
        <input class="dp-input" type="number" id="dp-number" min="0" max="100" placeholder="0-100">
        <label class="dp-label" for="dp-textarea">Comments</label>
        <textarea class="dp-textarea" id="dp-textarea" placeholder="Multi-line text"></textarea>
    </div>

    <!-- Clicks -->
    <div class="dp-section">
        <div class="dp-section-title">Click Actions</div>
        <button class="dp-btn" id="dp-click-btn">Single Click</button>
        <button class="dp-btn dp-btn-secondary" id="dp-dblclick-btn">Double-Click Me</button>
        <div id="dp-click-output" class="dp-result">Click output here</div>
    </div>

    <!-- Select / Dropdown -->
    <div class="dp-section">
        <div class="dp-section-title">Select & Dropdown</div>
        <label class="dp-label" for="dp-select">Choose option</label>
        <select class="dp-select" id="dp-select">
            <option value="">Select...</option>
            <option value="alpha">Alpha</option>
            <option value="beta">Beta</option>
            <option value="gamma">Gamma</option>
        </select>
        <label class="dp-label">Checkbox Group</label>
        <div class="dp-row"><label><input type="checkbox" id="dp-cb1" value="read"> Read</label></div>
        <div class="dp-row"><label><input type="checkbox" id="dp-cb2" value="write"> Write</label></div>
        <div class="dp-row"><label><input type="checkbox" id="dp-cb3" value="admin"> Admin</label></div>
        <label class="dp-label">Radio Group</label>
        <div class="dp-row"><label><input type="radio" name="dp-radio" value="low"> Low</label></div>
        <div class="dp-row"><label><input type="radio" name="dp-radio" value="medium" checked> Medium</label></div>
        <div class="dp-row"><label><input type="radio" name="dp-radio" value="high"> High</label></div>
    </div>

    <!-- Toggle -->
    <div class="dp-section">
        <div class="dp-section-title">Toggle Switches</div>
        <div class="dp-row">
            <div class="dp-toggle" id="dp-toggle1"><div class="dp-toggle-thumb"></div></div>
            <span style="font-weight:600;font-size:14px;">Dark Mode</span>
        </div>
        <div class="dp-row">
            <div class="dp-toggle" id="dp-toggle2"><div class="dp-toggle-thumb"></div></div>
            <span style="font-weight:600;font-size:14px;">Notifications</span>
        </div>
    </div>

    <!-- Hover -->
    <div class="dp-section">
        <div class="dp-section-title">Hover Interaction</div>
        <div class="dp-hover-zone" id="dp-hover-target">
            Hover over me for tooltip
            <span class="dp-tooltip" id="dp-tooltip">Tooltip from DOM context!</span>
        </div>
    </div>

    <!-- Date/Color Pickers -->
    <div class="dp-section">
        <div class="dp-section-title">Date & Color Pickers</div>
        <label class="dp-label" for="dp-date">Date</label>
        <input class="dp-input" type="date" id="dp-date">
        <label class="dp-label" for="dp-time">Time</label>
        <input class="dp-input" type="time" id="dp-time">
        <label class="dp-label" for="dp-color">Color</label>
        <input type="color" id="dp-color" value="#e11d48" style="width:60px;height:36px;padding:2px;cursor:pointer;border:1.5px solid #d2d6dc;border-radius:8px;">
    </div>

    <!-- Slider -->
    <div class="dp-section">
        <div class="dp-section-title">Range Slider</div>
        <label class="dp-label" for="dp-slider">Volume</label>
        <input type="range" id="dp-slider" min="0" max="100" value="50" style="width:100%;max-width:340px;cursor:grab;">
        <div style="font-family:monospace;font-size:12px;color:#94a3b8;" id="dp-slider-val">Value: 50</div>
    </div>

    <!-- Contenteditable -->
    <div class="dp-section">
        <div class="dp-section-title">Contenteditable</div>
        <div class="dp-editable" contenteditable="true" id="dp-editable">Type here — this is contenteditable, not an input element.</div>
    </div>

    <!-- File Upload -->
    <div class="dp-section">
        <div class="dp-section-title">File Upload</div>
        <label class="dp-label" for="dp-file">Choose file</label>
        <input type="file" id="dp-file" style="border:none;padding:0;font-size:14px;">
    </div>

    <!-- Assertable Content -->
    <div class="dp-section">
        <div class="dp-section-title">Assertable Content (Fix 4 — SmartWait skip)</div>
        <p class="dp-assert" id="dp-assert-text">Assertion target: Hello from this DOM context!</p>
        <p class="dp-assert" id="dp-assert-num">Numeric value: 256</p>
        <p id="dp-assert-status" style="display:inline-block;padding:4px 12px;border-radius:6px;font-weight:600;font-size:13px;background:#d1fae5;color:#059669;">Status: Active</p>
    </div>

    <!-- Output -->
    <div class="dp-result" id="dp-output">Interact with elements above — output appears here</div>
</div>
`;

var PANEL_JS_SRC = function(root) {
    // Text inputs
    ['dp-text','dp-email','dp-search','dp-password','dp-number'].forEach(function(id) {
        var el = root.getElementById ? root.getElementById(id) : root.querySelector('#' + id);
        if (el) el.addEventListener('input', function(e) {
            setOut(root, 'Input #' + id + ': "' + e.target.value + '"');
        });
    });
    var ta = root.getElementById ? root.getElementById('dp-textarea') : root.querySelector('#dp-textarea');
    if (ta) ta.addEventListener('input', function(e) { setOut(root, 'Textarea: "' + e.target.value + '"'); });

    // Clicks
    var clickBtn = root.getElementById ? root.getElementById('dp-click-btn') : root.querySelector('#dp-click-btn');
    if (clickBtn) clickBtn.addEventListener('click', function() {
        var out = root.getElementById ? root.getElementById('dp-click-output') : root.querySelector('#dp-click-output');
        if (out) out.textContent = 'Single click at ' + new Date().toLocaleTimeString();
        setOut(root, 'Single click');
    });
    var dblBtn = root.getElementById ? root.getElementById('dp-dblclick-btn') : root.querySelector('#dp-dblclick-btn');
    if (dblBtn) dblBtn.addEventListener('dblclick', function() {
        var out = root.getElementById ? root.getElementById('dp-click-output') : root.querySelector('#dp-click-output');
        if (out) out.textContent = 'Double-click at ' + new Date().toLocaleTimeString();
        setOut(root, 'Double-click');
    });

    // Select
    var sel = root.getElementById ? root.getElementById('dp-select') : root.querySelector('#dp-select');
    if (sel) sel.addEventListener('change', function(e) { setOut(root, 'Selected: ' + e.target.value); });

    // Checkboxes
    ['dp-cb1','dp-cb2','dp-cb3'].forEach(function(id) {
        var el = root.getElementById ? root.getElementById(id) : root.querySelector('#' + id);
        if (el) el.addEventListener('change', function(e) { setOut(root, 'Checkbox ' + e.target.value + ': ' + (e.target.checked ? 'ON' : 'OFF')); });
    });

    // Radios
    root.querySelectorAll('input[name="dp-radio"]').forEach(function(r) {
        r.addEventListener('change', function() { setOut(root, 'Radio: ' + r.value); });
    });

    // Toggles
    ['dp-toggle1','dp-toggle2'].forEach(function(id) {
        var el = root.getElementById ? root.getElementById(id) : root.querySelector('#' + id);
        if (el) el.addEventListener('click', function() {
            var isOn = el.classList.toggle('on');
            setOut(root, id + ': ' + (isOn ? 'ON' : 'OFF'));
        });
    });

    // Hover
    var hoverT = root.getElementById ? root.getElementById('dp-hover-target') : root.querySelector('#dp-hover-target');
    var tooltip = root.getElementById ? root.getElementById('dp-tooltip') : root.querySelector('#dp-tooltip');
    if (hoverT && tooltip) {
        hoverT.addEventListener('mouseenter', function() { tooltip.style.display = 'block'; setOut(root, 'Hover: tooltip visible'); });
        hoverT.addEventListener('mouseleave', function() { tooltip.style.display = 'none'; });
    }

    // Date/time/color
    ['dp-date','dp-time','dp-color'].forEach(function(id) {
        var el = root.getElementById ? root.getElementById(id) : root.querySelector('#' + id);
        if (el) el.addEventListener('change', function(e) { setOut(root, id + ': ' + e.target.value); });
    });

    // Slider
    var slider = root.getElementById ? root.getElementById('dp-slider') : root.querySelector('#dp-slider');
    if (slider) slider.addEventListener('input', function(e) {
        var valEl = root.getElementById ? root.getElementById('dp-slider-val') : root.querySelector('#dp-slider-val');
        if (valEl) valEl.textContent = 'Value: ' + e.target.value;
        setOut(root, 'Slider: ' + e.target.value);
    });

    // Contenteditable
    var editable = root.getElementById ? root.getElementById('dp-editable') : root.querySelector('#dp-editable');
    if (editable) editable.addEventListener('input', function(e) { setOut(root, 'Editable: "' + e.target.textContent.substring(0, 50) + '"'); });

    // File
    var fileInput = root.getElementById ? root.getElementById('dp-file') : root.querySelector('#dp-file');
    if (fileInput) fileInput.addEventListener('change', function(e) {
        var f = e.target.files[0];
        setOut(root, f ? 'File: ' + f.name : 'No file');
    });

    function setOut(r, msg) {
        var out = r.getElementById ? r.getElementById('dp-output') : r.querySelector('#dp-output');
        if (out) out.textContent = '[' + new Date().toLocaleTimeString() + '] ' + msg;
        // Also update parent result box
        var parentResult = document.getElementById('domSwitchResult');
        if (parentResult) parentResult.textContent = '[' + currentDomMode.toUpperCase() + '] ' + msg;
    }
};

var currentDomMode = 'standard';

function switchDom(mode) {
    currentDomMode = mode;
    var target = document.getElementById('domRenderTarget');
    var label = document.getElementById('domContextLabel');

    // Update button styles via CSS classes
    document.querySelectorAll('.dom-btn').forEach(function(btn) {
        btn.classList.remove('dom-btn-active');
    });
    document.getElementById('domBtn-' + mode).classList.add('dom-btn-active');

    // Clear target
    target.innerHTML = '';

    if (mode === 'standard') {
        label.innerHTML = '<span class="dom-context-badge" style="background:rgba(5,150,105,0.15);color:#34d399;">ACTIVE: Standard DOM</span>';
        var container = document.createElement('div');
        container.innerHTML = DOM_PANEL_HTML;
        // Override hardcoded light colors with theme-aware CSS variables for standard DOM
        var themeStyle = document.createElement('style');
        themeStyle.textContent = '.dp-section{background:var(--bg-secondary)!important;border-color:var(--border-default)!important}.dp-section-title{color:var(--text-primary)!important}.dp-label{color:var(--text-secondary)!important}.dp-input,.dp-textarea,.dp-select{background:var(--bg-input)!important;border-color:var(--border-default)!important;color:var(--text-primary)!important}.dp-result{background:var(--bg-secondary)!important;border-color:var(--border-default)!important;color:var(--text-primary)!important}.dp-editable{background:var(--bg-input)!important;border-color:var(--border-default)!important;color:var(--text-primary)!important}.dp-drag-item{background:var(--bg-card)!important;border-color:var(--border-default)!important;color:var(--text-primary)!important}.dp-hover-zone{background:var(--bg-secondary)!important;color:var(--text-primary)!important}';
        container.prepend(themeStyle);
        target.appendChild(container);
        PANEL_JS_SRC(container);
    }
    else if (mode === 'shadow') {
        label.innerHTML = '<span class="dom-context-badge" style="background:rgba(124,58,237,0.15);color:#a78bfa;">ACTIVE: Shadow DOM (open)</span>';
        var host = document.createElement('div');
        host.id = 'shadow-dom-host';
        target.appendChild(host);
        var shadow = host.attachShadow({ mode: 'open' });
        shadow.innerHTML = DOM_PANEL_HTML;
        PANEL_JS_SRC(shadow);
    }
    else if (mode === 'iframe') {
        label.innerHTML = '<span class="dom-context-badge" style="background:rgba(6,182,212,0.15);color:#22d3ee;">ACTIVE: Iframe (static src)</span>';
        var iframe = document.createElement('iframe');
        iframe.id = 'dom-context-iframe';
        iframe.src = 'iframe-panel.html';
        iframe.style.cssText = 'width:100%;border:2px solid #0891b2;border-radius:10px;min-height:400px;';
        iframe.title = 'DOM Context: Iframe';
        target.appendChild(iframe);

        // Auto-resize iframe to fit content after load
        iframe.addEventListener('load', function() {
            try {
                var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                var h = iframeDoc.documentElement.scrollHeight;
                if (h > 100) iframe.style.height = (h + 20) + 'px';
            } catch(e) {}
        });

        // Listen for messages from iframe to update parent result box
        window.addEventListener('message', function handler(e) {
            if (e.data && e.data.type === 'iframe-panel-event' && currentDomMode === 'iframe') {
                var parentResult = document.getElementById('domSwitchResult');
                if (parentResult) parentResult.textContent = '[IFRAME] ' + e.data.message;
            }
        });
    }

    document.getElementById('domSwitchResult').textContent = 'Switched to: ' + mode.toUpperCase() + ' — interact with elements above';
}

// Initialize with standard DOM on load
switchDom('standard');
</script>

<!-- INPUT VALUE MONITOR SCRIPT -->
<script>
(function() {
    var eventValue = '';
    var keyLog = [];
    var activeField = null;
    var inputEventFired = false;
    var activeGroup = null;
    var activeGroupLabel = '';

    function getFieldLabel(el) {
        var label = '';
        if (el.id) label = '#' + el.id;
        else if (el.name) label = '[name=' + el.name + ']';
        else if (el.placeholder) label = '"' + el.placeholder.substring(0, 20) + '..."';
        else if (el.className) label = '.' + el.className.split(' ')[0];
        else label = el.tagName.toLowerCase();
        var type = el.getAttribute('type') || el.tagName.toLowerCase();
        return label + ' (' + type + ')';
    }

    function detectGroup(el) {
        if (el.tagName !== 'INPUT') return null;
        if (el.getAttribute('maxlength') !== '1') return null;
        var parent = el.parentElement;
        if (!parent) return null;
        var elClasses = Array.from(el.classList);
        var siblings = Array.from(parent.querySelectorAll('input[maxlength="1"]'));
        if (siblings.length < 2) return null;
        if (elClasses.length === 0) return siblings;
        var group = siblings.filter(function(sib) {
            return elClasses.some(function(cls) { return sib.classList.contains(cls); });
        });
        return group.length >= 2 ? group : null;
    }

    function getGroupLabel(group) {
        if (!group || group.length === 0) return '';
        var first = group[0]; var last = group[group.length - 1];
        var type = 'Group';
        if (first.classList.contains('otp-digit')) type = 'OTP';
        else if (first.classList.contains('pin-digit')) type = 'PIN';
        var firstId = first.id ? '#' + first.id : '?';
        var lastId = last.id ? '#' + last.id : '?';
        return type + ' ' + firstId + ' \u2192 ' + lastId + ' (' + group.length + ' fields)';
    }

    function getGroupValue(group) {
        if (!group) return '';
        return group.map(function(el) { return el.value || '_'; }).join('');
    }

    function isSameGroup(a, b) {
        if (!a || !b) return false;
        if (a.length !== b.length) return false;
        return a[0] === b[0];
    }

    function updateBar() {
        var domVal = activeField ? (activeField.value || activeField.textContent || '') : '';
        document.getElementById('monitorActiveField').textContent = activeField ? getFieldLabel(activeField) : '\u2014';
        document.getElementById('monitorEventValue').textContent = eventValue || '\u2014';
        document.getElementById('monitorDomValue').textContent = domVal || '\u2014';
        document.getElementById('monitorKeyLog').textContent = keyLog.length > 0 ? keyLog.slice(-20).join('') : '\u2014';

        var domValEl = document.getElementById('monitorDomValue');
        var sourceEl = document.getElementById('monitorSource');
        var groupSection = document.getElementById('monitorGroupSection');
        var groupDivider = document.getElementById('monitorGroupDivider');

        if (activeGroup && activeGroup.length > 1) {
            document.getElementById('monitorGroupLabel').textContent = activeGroupLabel;
            document.getElementById('monitorGroupValue').textContent = getGroupValue(activeGroup);
            groupSection.style.display = '';
            groupDivider.style.display = '';
        } else {
            groupSection.style.display = 'none';
            groupDivider.style.display = 'none';
        }

        if (!activeField || (!eventValue && !domVal)) {
            sourceEl.textContent = '\u2014';
            sourceEl.className = 'monitor-source';
            domValEl.className = 'monitor-value';
        } else if (inputEventFired && eventValue === domVal) {
            sourceEl.textContent = 'REAL INPUT';
            sourceEl.className = 'monitor-source source-real';
            domValEl.className = 'monitor-value match';
        } else if (domVal && !inputEventFired) {
            sourceEl.textContent = 'JS INJECTED';
            sourceEl.className = 'monitor-source source-js';
            domValEl.className = 'monitor-value js-injected';
        } else if (eventValue !== domVal) {
            sourceEl.textContent = 'MODIFIED';
            sourceEl.className = 'monitor-source source-js';
            domValEl.className = 'monitor-value js-injected';
        } else {
            sourceEl.textContent = 'REAL INPUT';
            sourceEl.className = 'monitor-source source-real';
            domValEl.className = 'monitor-value match';
        }
    }

    document.addEventListener('focusin', function(e) {
        var tag = e.target.tagName;
        var isEditable = e.target.isContentEditable;
        if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT' || isEditable) {
            var newGroup = detectGroup(e.target);
            var stayingInGroup = isSameGroup(newGroup, activeGroup);
            activeField = e.target;
            eventValue = e.target.value || e.target.textContent || '';
            if (stayingInGroup) {
                inputEventFired = true;
            } else {
                keyLog = [];
                inputEventFired = false;
                activeGroup = newGroup;
                activeGroupLabel = newGroup ? getGroupLabel(newGroup) : '';
            }
            updateBar();
        }
    }, true);

    document.addEventListener('keydown', function(e) {
        if (!activeField) return;
        var isGroupKey = activeGroup && activeGroup.indexOf(e.target) !== -1;
        if (e.target !== activeField && !isGroupKey && !activeField.contains(e.target)) return;
        var key = e.key;
        if (key === 'Backspace') keyLog.push('\u232b');
        else if (key === 'Enter') keyLog.push('\u21b5');
        else if (key === 'Tab') keyLog.push('\u21e5');
        else if (key === 'Shift' || key === 'Control' || key === 'Alt' || key === 'Meta') { /* skip modifiers */ }
        else if (key.length === 1) keyLog.push(key);
        updateBar();
    }, true);

    document.addEventListener('input', function(e) {
        if (!activeField) return;
        var isGroupInput = activeGroup && activeGroup.indexOf(e.target) !== -1;
        if (e.target !== activeField && !isGroupInput && !activeField.contains(e.target)) return;
        inputEventFired = true;
        eventValue = e.target.value || e.target.textContent || '';
        activeField = e.target;
        updateBar();
    }, true);

    document.addEventListener('change', function(e) {
        if (e.target.tagName === 'SELECT') {
            activeField = e.target;
            activeGroup = null;
            activeGroupLabel = '';
            inputEventFired = true;
            eventValue = e.target.value;
            updateBar();
        }
    }, true);

    setInterval(function() {
        if (activeField) updateBar();
    }, 500);
})();
</script>

<!-- THEME TOGGLE -->
<script>
document.getElementById('themeToggle').addEventListener('click', function() {
    var html = document.documentElement;
    var current = html.getAttribute('data-theme') || 'dark';
    var next = current === 'dark' ? 'light' : 'dark';
    html.setAttribute('data-theme', next);
    localStorage.setItem('lt-theme', next);
});
</script>
<script>
(function() {
    var g1 = document.querySelector('.glow-container:not(.glow-2)');
    var g2 = document.querySelector('.glow-container.glow-2');
    if (!g1) return;
    var mx = window.innerWidth / 2, my = window.innerHeight / 2;
    var cx = mx, cy = my, cx2 = mx, cy2 = my;
    g1.style.transform = 'translate(' + (mx - 400) + 'px,' + (my - 400) + 'px)';
    if (g2) g2.style.transform = 'translate(' + (mx - 300) + 'px,' + (my - 300) + 'px)';
    document.addEventListener('mousemove', function(e) { mx = e.clientX; my = e.clientY; });
    (function loop() {
        cx += (mx - cx) * 0.08;
        cy += (my - cy) * 0.08;
        cx2 += (mx - cx2) * 0.035;
        cy2 += (my - cy2) * 0.035;
        g1.style.transform = 'translate(' + (cx - 400) + 'px,' + (cy - 400) + 'px)';
        if (g2) g2.style.transform = 'translate(' + (cx2 - 300) + 'px,' + (cy2 - 300) + 'px)';
        requestAnimationFrame(loop);
    })();
})();
</script>
</body>
</html>
