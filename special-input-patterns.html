<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <title>Special Input Patterns</title>
    <link rel="stylesheet" href="design-system.css">
    <style>
        /* Page-specific overrides */
        .otp-container input, .pin-container input {
            max-width: 56px;
            width: 56px;
            height: 56px;
        }
    </style>
</head>
<body class="has-monitor">
<script>(function(){var t=localStorage.getItem('lt-theme')||(window.matchMedia('(prefers-color-scheme:light)').matches?'light':'dark');document.documentElement.setAttribute('data-theme',t);})();</script>
<!-- INPUT VALUE MONITOR BAR -->
<div id="inputMonitorBar">
    <span class="monitor-title">Input Monitor</span>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">Active:</span>
        <span class="monitor-element-id" id="monitorActiveField">—</span>
    </div>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">Event Value:</span>
        <span class="monitor-value" id="monitorEventValue">—</span>
    </div>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">.value:</span>
        <span class="monitor-value" id="monitorDomValue">—</span>
    </div>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">Source:</span>
        <span class="monitor-source" id="monitorSource">—</span>
    </div>
    <div class="monitor-divider"></div>
    <div class="monitor-field">
        <span class="monitor-label">Keys:</span>
        <span class="monitor-value" id="monitorKeyLog" style="max-width:200px;">—</span>
    </div>
    <div class="monitor-divider" id="monitorGroupDivider" style="display:none;"></div>
    <div class="monitor-field" id="monitorGroupSection" style="display:none;">
        <span class="monitor-group-label" id="monitorGroupLabel">—</span>
        <span class="monitor-value group-val" id="monitorGroupValue">—</span>
    </div>
</div>

<div class="glow-container"><div class="glow-inner"></div></div>
<div class="glow-container glow-2"><div class="glow-inner"></div></div>

<header class="site-header">
    <div class="header-inner">
        <a href="index.html" class="logo">
            <div class="logo-icon">LT</div>
            <div class="logo-text">Special Inputs</div>
        </a>
        <nav class="header-nav">
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <span class="icon-sun">&#9728;</span>
                <span class="icon-moon">&#9790;</span>
            </button>
            <a href="index.html" class="header-btn">
                <svg viewBox="0 0 20 20" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 10H5M5 10l4-4M5 10l4 4"/></svg>
                <span class="hide-mobile">All Pages</span>
            </a>
        </nav>
    </div>
</header>

<main class="container-narrow">

<div class="page-hero">
    <h1>Special Input Patterns</h1>
    <p class="subtitle">OTP, PIN, Credit Card, Phone Mask, Currency, Date & Autocomplete</p>
</div>

    <!-- OTP 4-digit (auto-tab) -->
    <div class="section-card">
        <div class="section-card-header"><h2>OTP — 4-Digit (Auto-Tab)</h2></div>
        <p>Each field auto-tabs to the next after a digit is entered.</p>
        <div class="otp-container">
            <input type="text" class="otp-digit" id="otp1" maxlength="1" data-next="otp2" autofocus>
            <input type="text" class="otp-digit" id="otp2" maxlength="1" data-next="otp3">
            <input type="text" class="otp-digit" id="otp3" maxlength="1" data-next="otp4">
            <input type="text" class="otp-digit" id="otp4" maxlength="1">
        </div>
        <div class="result-box" id="otp-result">OTP: waiting...</div>
    </div>

    <!-- OTP 6-digit (single field) -->
    <div class="section-card">
        <div class="section-card-header"><h2>OTP — 6-Digit (Single Field)</h2></div>
        <label for="otp6">6-Digit OTP</label>
        <input type="text" id="otp6" maxlength="6" placeholder="______" style="max-width:120px; letter-spacing: 8px; font-size: 18px; text-align: center;">
        <span class="hint">Single input with maxlength=6, spaced characters</span>
    </div>

    <!-- PIN (masked, auto-tab) -->
    <div class="section-card">
        <div class="section-card-header"><h2>PIN — 4-Digit (Masked, Auto-Tab)</h2></div>
        <div class="pin-container">
            <input type="password" class="pin-digit" id="pin1" maxlength="1" data-next="pin2">
            <input type="password" class="pin-digit" id="pin2" maxlength="1" data-next="pin3">
            <input type="password" class="pin-digit" id="pin3" maxlength="1" data-next="pin4">
            <input type="password" class="pin-digit" id="pin4" maxlength="1">
        </div>
        <span class="hint">Like OTP but type="password" — digits are masked</span>
        <div class="result-box" id="pin-result">PIN: waiting...</div>
    </div>

    <!-- Credit Card -->
    <div class="section-card">
        <div class="section-card-header"><h2>Credit Card Number (Auto-Space)</h2></div>
        <label for="cardNumber">Card Number</label>
        <input type="text" id="cardNumber" maxlength="19" placeholder="0000 0000 0000 0000" style="max-width: 250px; font-size: 16px; letter-spacing: 2px;">
        <span class="hint">Formats as: XXXX XXXX XXXX XXXX</span>

        <label for="cardExpiry">Expiry (MM/YY)</label>
        <input type="text" id="cardExpiry" maxlength="5" placeholder="MM/YY" style="max-width: 80px;">
        <span class="hint">Auto-inserts / after MM</span>

        <label for="cardCvv">CVV</label>
        <input type="password" id="cardCvv" maxlength="4" placeholder="***" style="max-width: 60px;">
        <span class="hint">3-4 digit security code (masked)</span>
    </div>

    <!-- Phone Mask -->
    <div class="section-card">
        <div class="section-card-header"><h2>Phone Number (Auto-Mask)</h2></div>
        <label for="phoneMask">Phone (Masked)</label>
        <input type="tel" id="phoneMask" placeholder="(___) ___-____" style="max-width: 200px;">
        <span class="hint">Formats as: (XXX) XXX-XXXX</span>
    </div>

    <!-- Currency -->
    <div class="section-card">
        <div class="section-card-header"><h2>Currency Input (Auto-Comma)</h2></div>
        <label for="currency">Amount</label>
        <input type="text" id="currency" placeholder="$0.00" style="max-width: 200px;">
        <span class="hint">Auto-formats with $ and commas: $1,234,567</span>
    </div>

    <!-- Date Mask -->
    <div class="section-card">
        <div class="section-card-header"><h2>Date Mask (DD/MM/YYYY)</h2></div>
        <label for="dateMask">Date (DD/MM/YYYY)</label>
        <input type="text" id="dateMask" maxlength="10" placeholder="DD/MM/YYYY" style="max-width: 150px;">
        <span class="hint">Auto-inserts / separators</span>
    </div>

    <!-- Tags Input -->
    <div class="section-card">
        <div class="section-card-header"><h2>Tags Input (Type + Enter)</h2></div>
        <label for="tagInput">Add Tag</label>
        <div id="tags-container" style="min-height:44px;box-shadow:inset 0 0 0 1px var(--border-default);border-radius:var(--radius-md);padding:8px;width:100%;max-width:400px;background:var(--bg-input);"></div>
        <input type="text" id="tagInput" placeholder="Type and press Enter" style="max-width: 380px;">
        <span class="hint">Press Enter to add as tag chip</span>
    </div>

    <!-- Autocomplete / Typeahead -->
    <div class="section-card">
        <div class="section-card-header"><h2>Autocomplete / Typeahead</h2></div>
        <label for="citySearch">City Search</label>
        <div class="autocomplete-wrap">
            <input type="text" id="citySearch" placeholder="Start typing a city..." style="max-width: 360px;" autocomplete="off">
            <div id="cityDropdown" class="dropdown" style="display:none;"></div>
        </div>
        <span class="hint">Shows matching cities as you type</span>
    </div>

</main>

<footer class="site-footer">KaneAI Test Suite &mdash; Special Input Patterns</footer>

    <script>
        // --- OTP Auto-Tab ---
        document.querySelectorAll('.otp-digit').forEach(function(input) {
            input.addEventListener('input', function() {
                if (this.value.length === 1 && this.dataset.next) {
                    document.getElementById(this.dataset.next).focus();
                }
                var digits = document.querySelectorAll('.otp-digit');
                var otp = '';
                digits.forEach(function(d) { otp += d.value; });
                document.getElementById('otp-result').textContent = 'OTP: ' + (otp.length === 4 ? otp : 'waiting...');
            });
        });

        // --- PIN Auto-Tab ---
        document.querySelectorAll('.pin-digit').forEach(function(input) {
            input.addEventListener('input', function() {
                if (this.value.length === 1 && this.dataset.next) {
                    document.getElementById(this.dataset.next).focus();
                }
                var digits = document.querySelectorAll('.pin-digit');
                var pin = '';
                digits.forEach(function(d) { pin += d.value; });
                document.getElementById('pin-result').textContent = 'PIN: ' + (pin.length === 4 ? '****' : 'waiting...');
            });
        });

        // --- Credit Card Formatting ---
        document.getElementById('cardNumber').addEventListener('input', function() {
            var val = this.value.replace(/\s/g, '').replace(/\D/g, '');
            var parts = val.match(/.{1,4}/g);
            this.value = parts ? parts.join(' ') : '';
        });

        document.getElementById('cardExpiry').addEventListener('input', function() {
            var val = this.value.replace(/\//g, '').replace(/\D/g, '');
            if (val.length >= 2) {
                val = val.substring(0, 2) + '/' + val.substring(2);
            }
            this.value = val;
        });

        // --- Phone Mask ---
        document.getElementById('phoneMask').addEventListener('input', function() {
            var val = this.value.replace(/\D/g, '');
            if (val.length >= 6) {
                this.value = '(' + val.substring(0, 3) + ') ' + val.substring(3, 6) + '-' + val.substring(6, 10);
            } else if (val.length >= 3) {
                this.value = '(' + val.substring(0, 3) + ') ' + val.substring(3);
            } else if (val.length > 0) {
                this.value = '(' + val;
            }
        });

        // --- Currency Formatting ---
        document.getElementById('currency').addEventListener('input', function() {
            var val = this.value.replace(/[$,]/g, '').replace(/\D/g, '');
            if (val) {
                this.value = '$' + parseInt(val).toLocaleString('en-US');
            }
        });

        // --- Date Mask ---
        document.getElementById('dateMask').addEventListener('input', function() {
            var val = this.value.replace(/\//g, '').replace(/\D/g, '');
            if (val.length >= 4) {
                this.value = val.substring(0, 2) + '/' + val.substring(2, 4) + '/' + val.substring(4, 8);
            } else if (val.length >= 2) {
                this.value = val.substring(0, 2) + '/' + val.substring(2);
            }
        });

        // --- Tags Input ---
        document.getElementById('tagInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && this.value.trim()) {
                e.preventDefault();
                var tag = document.createElement('span');
                tag.className = 'tag-chip';
                tag.innerHTML = this.value.trim() + '<span class="remove" onclick="this.parentElement.remove()">x</span>';
                document.getElementById('tags-container').appendChild(tag);
                this.value = '';
            }
        });

        // --- Autocomplete / Typeahead ---
        var cities = [
            'New York', 'New Delhi', 'New Orleans', 'Newark', 'Newcastle',
            'London', 'Los Angeles', 'Las Vegas', 'Lagos', 'Lima',
            'Paris', 'Prague', 'Perth', 'Portland', 'Phoenix',
            'Tokyo', 'Toronto', 'Taipei', 'Tehran', 'Tashkent',
            'Berlin', 'Bangkok', 'Brussels', 'Budapest', 'Bangalore'
        ];

        document.getElementById('citySearch').addEventListener('input', function() {
            var query = this.value.toLowerCase();
            var dropdown = document.getElementById('cityDropdown');
            if (query.length < 1) {
                dropdown.style.display = 'none';
                return;
            }
            var matches = cities.filter(function(c) {
                return c.toLowerCase().includes(query);
            });
            if (matches.length > 0) {
                dropdown.innerHTML = matches.map(function(c) {
                    return '<div class="dropdown-item" onclick="selectCity(\'' + c + '\')">' + c + '</div>';
                }).join('');
                dropdown.style.display = 'block';
            } else {
                dropdown.style.display = 'none';
            }
        });

        function selectCity(city) {
            document.getElementById('citySearch').value = city;
            document.getElementById('cityDropdown').style.display = 'none';
        }

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.autocomplete-wrap')) {
                document.getElementById('cityDropdown').style.display = 'none';
            }
        });
    </script>
<!-- INPUT VALUE MONITOR SCRIPT -->
<script>
(function() {
    var eventValue = '';
    var keyLog = [];
    var activeField = null;
    var inputEventFired = false;
    var activeGroup = null;       // array of sibling fields in an OTP/PIN group
    var activeGroupLabel = '';    // label like "OTP #otp1-#otp4"

    function getFieldLabel(el) {
        var label = '';
        if (el.id) label = '#' + el.id;
        else if (el.name) label = '[name=' + el.name + ']';
        else if (el.placeholder) label = '"' + el.placeholder.substring(0, 20) + '..."';
        else if (el.className) label = '.' + el.className.split(' ')[0];
        else label = el.tagName.toLowerCase();
        var type = el.getAttribute('type') || el.tagName.toLowerCase();
        return label + ' (' + type + ')';
    }

    // Detect if a field belongs to an OTP/PIN-style group:
    // siblings in same container that share a class AND have maxlength="1"
    function detectGroup(el) {
        if (el.tagName !== 'INPUT') return null;
        if (el.getAttribute('maxlength') !== '1') return null;
        var parent = el.parentElement;
        if (!parent) return null;
        // Find sibling inputs with maxlength="1" sharing at least one class
        var elClasses = Array.from(el.classList);
        var siblings = Array.from(parent.querySelectorAll('input[maxlength="1"]'));
        if (siblings.length < 2) return null;
        // Filter to those sharing a common class with the focused element
        var group = siblings.filter(function(sib) {
            return elClasses.some(function(cls) { return sib.classList.contains(cls); });
        });
        if (group.length < 2) return null;
        return group;
    }

    function getGroupLabel(group) {
        if (!group || group.length === 0) return '';
        var first = group[0];
        var last = group[group.length - 1];
        var type = 'Group';
        if (first.classList.contains('otp-digit')) type = 'OTP';
        else if (first.classList.contains('pin-digit')) type = 'PIN';
        var firstId = first.id ? '#' + first.id : '?';
        var lastId = last.id ? '#' + last.id : '?';
        return type + ' ' + firstId + ' → ' + lastId + ' (' + group.length + ' fields)';
    }

    function getGroupValue(group) {
        if (!group) return '';
        return group.map(function(el) { return el.value || '_'; }).join('');
    }

    function isSameGroup(groupA, groupB) {
        if (!groupA || !groupB) return false;
        if (groupA.length !== groupB.length) return false;
        return groupA[0] === groupB[0];
    }

    function updateBar() {
        var domVal = activeField ? (activeField.value || activeField.textContent || '') : '';
        document.getElementById('monitorActiveField').textContent = activeField ? getFieldLabel(activeField) : '—';
        document.getElementById('monitorEventValue').textContent = eventValue || '—';
        document.getElementById('monitorDomValue').textContent = domVal || '—';
        document.getElementById('monitorKeyLog').textContent = keyLog.length > 0 ? keyLog.slice(-20).join('') : '—';

        var domValEl = document.getElementById('monitorDomValue');
        var sourceEl = document.getElementById('monitorSource');

        // OTP/PIN group display
        var groupSection = document.getElementById('monitorGroupSection');
        var groupDivider = document.getElementById('monitorGroupDivider');
        if (activeGroup && activeGroup.length > 1) {
            var groupVal = getGroupValue(activeGroup);
            document.getElementById('monitorGroupLabel').textContent = activeGroupLabel;
            document.getElementById('monitorGroupValue').textContent = groupVal;
            groupSection.style.display = '';
            groupDivider.style.display = '';
        } else {
            groupSection.style.display = 'none';
            groupDivider.style.display = 'none';
        }

        // Source detection
        if (!activeField || (!eventValue && !domVal)) {
            sourceEl.textContent = '—';
            sourceEl.className = 'monitor-source';
            domValEl.className = 'monitor-value';
        } else if (inputEventFired && eventValue === domVal) {
            sourceEl.textContent = 'REAL INPUT';
            sourceEl.className = 'monitor-source source-real';
            domValEl.className = 'monitor-value match';
        } else if (domVal && !inputEventFired) {
            sourceEl.textContent = 'JS INJECTED';
            sourceEl.className = 'monitor-source source-js';
            domValEl.className = 'monitor-value js-injected';
        } else if (eventValue !== domVal) {
            sourceEl.textContent = 'MODIFIED';
            sourceEl.className = 'monitor-source source-js';
            domValEl.className = 'monitor-value js-injected';
        } else {
            sourceEl.textContent = 'REAL INPUT';
            sourceEl.className = 'monitor-source source-real';
            domValEl.className = 'monitor-value match';
        }
    }

    document.addEventListener('focusin', function(e) {
        var tag = e.target.tagName;
        var isEditable = e.target.isContentEditable;
        if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT' || isEditable) {
            var newGroup = detectGroup(e.target);
            var stayingInGroup = isSameGroup(newGroup, activeGroup);

            activeField = e.target;
            eventValue = e.target.value || e.target.textContent || '';

            if (stayingInGroup) {
                // OTP auto-tab: keep keyLog, keep inputEventFired, just update active field
                inputEventFired = true;
            } else {
                // New field or new group: reset
                keyLog = [];
                inputEventFired = false;
                activeGroup = newGroup;
                activeGroupLabel = newGroup ? getGroupLabel(newGroup) : '';
            }
            updateBar();
        }
    }, true);

    document.addEventListener('keydown', function(e) {
        if (!activeField) return;
        // For group fields, accept keydown from any field in the group
        var isGroupKey = activeGroup && activeGroup.indexOf(e.target) !== -1;
        if (e.target !== activeField && !isGroupKey && !activeField.contains(e.target)) return;
        var key = e.key;
        if (key === 'Backspace') keyLog.push('\u232b');
        else if (key === 'Enter') keyLog.push('\u21b5');
        else if (key === 'Tab') keyLog.push('\u21e5');
        else if (key === 'Shift' || key === 'Control' || key === 'Alt' || key === 'Meta') { /* skip modifiers */ }
        else if (key.length === 1) keyLog.push(key);
        updateBar();
    }, true);

    document.addEventListener('input', function(e) {
        if (!activeField) return;
        // For group fields, accept input from any field in the group
        var isGroupInput = activeGroup && activeGroup.indexOf(e.target) !== -1;
        if (e.target !== activeField && !isGroupInput && !activeField.contains(e.target)) return;
        inputEventFired = true;
        eventValue = e.target.value || e.target.textContent || '';
        // Update activeField to the element that actually received input
        activeField = e.target;
        updateBar();
    }, true);

    document.addEventListener('change', function(e) {
        if (e.target.tagName === 'SELECT') {
            activeField = e.target;
            activeGroup = null;
            activeGroupLabel = '';
            inputEventFired = true;
            eventValue = e.target.value;
            updateBar();
        }
    }, true);

    // Poll for JS-injected values (detects element.value = "..." without events)
    setInterval(function() {
        if (activeField) updateBar();
    }, 500);
})();
</script>
<script>
document.getElementById('themeToggle').addEventListener('click', function() {
    var html = document.documentElement;
    var current = html.getAttribute('data-theme') || 'dark';
    var next = current === 'dark' ? 'light' : 'dark';
    html.setAttribute('data-theme', next);
    localStorage.setItem('lt-theme', next);
});
</script>
<script>
(function() {
    var g1 = document.querySelector('.glow-container:not(.glow-2)');
    var g2 = document.querySelector('.glow-container.glow-2');
    if (!g1) return;
    var mx = window.innerWidth / 2, my = window.innerHeight / 2;
    var cx = mx, cy = my, cx2 = mx, cy2 = my;
    g1.style.transform = 'translate(' + (mx - 400) + 'px,' + (my - 400) + 'px)';
    if (g2) g2.style.transform = 'translate(' + (mx - 300) + 'px,' + (my - 300) + 'px)';
    document.addEventListener('mousemove', function(e) { mx = e.clientX; my = e.clientY; });
    (function loop() {
        cx += (mx - cx) * 0.08;
        cy += (my - cy) * 0.08;
        cx2 += (mx - cx2) * 0.035;
        cy2 += (my - cy2) * 0.035;
        g1.style.transform = 'translate(' + (cx - 400) + 'px,' + (cy - 400) + 'px)';
        if (g2) g2.style.transform = 'translate(' + (cx2 - 300) + 'px,' + (cy2 - 300) + 'px)';
        requestAnimationFrame(loop);
    })();
})();
</script>
</body>
</html>
